<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BlueprintLists  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>

    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="BlueprintLists  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          BlueprintLists
        </a>
         (100% documented)
      </p>

      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>

        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/kyleve/Listable">
            <img class="header-icon" src="img/gh.png" alt="GitHub"/>
            View on GitHub
          </a>
        </p>

    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">BlueprintLists Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      BlueprintLists  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ListContentContextKey.html">ListContentContextKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Element.html">Element</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Environment.html">Environment</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:16BlueprintUILists19ElementHeaderFooter_7element10background17pressedBackground9configure10ListableUI0dE0VyAA0cdE7ContentVyxGGx_0aL00C0_pxcAnO_pSgxcAPxcyAMzXEtSQRzlF">ElementHeaderFooter(_:element:background:pressedBackground:configure:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:16BlueprintUILists19ElementHeaderFooter_12isEquivalent7element10background17pressedBackground9configure10ListableUI0dE0VyAA0cdE7ContentVyxGGx_Sbx_xtc0aN00C0_pxcAoP_pSgxcAQxcyANzXEtlF">ElementHeaderFooter(_:isEquivalent:element:background:pressedBackground:configure:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:16BlueprintUILists11ElementItem_2id7element10background18selectedBackground9configure10ListableUI0D0VyAA0cD7ContentVyxq_GGx_s7KeyPathCyxq_G0aL00C0_px_AH05ApplydM4InfoVtcArS_pSgx_AUtcAVx_AUtcyANzXEtSQRzSHR_r0_lF">ElementItem(_:id:element:background:selectedBackground:configure:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:16BlueprintUILists11ElementItem_2id12isEquivalent7element10background18selectedBackground9configure10ListableUI0D0VyAA0cD7ContentVyxq_GGx_s7KeyPathCyxq_GSbx_xtc0aN00C0_px_AI05ApplydO4InfoVtcAsT_pSgx_AVtcAWx_AVtcyAOzXEtSHR_r0_lF">ElementItem(_:id:isEquivalent:element:background:selectedBackground:configure:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:16BlueprintUILists19preconditionFailure_4file4lines5NeverOSSyXK_s12StaticStringVSutF">preconditionFailure(_:file:line:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/BlueprintHeaderFooterContent.html">BlueprintHeaderFooterContent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/BlueprintItemContent.html">BlueprintItemContent</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ElementHeaderFooterContent.html">ElementHeaderFooterContent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ElementItemContent.html">ElementItemContent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/List.html">List</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/List/Measurement.html">– Measurement</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ListReorderGesture.html">ListReorderGesture</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ListReorderGesture/Begins.html">– Begins</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:16BlueprintUILists0A13FooterContenta">BlueprintFooterContent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:16BlueprintUILists0A13HeaderContenta">BlueprintHeaderContent</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">

            <p><strong>Note</strong> – Listable is still experimental :see_no_evil:. While it is shipping in <a href="https://squareup.com/us/en/point-of-sale">Square Point of Sale</a> in several places, we&rsquo;re still actively iterating on the API, and backfilling comprehensive tests. As such, expect things to break and change in the coming months.</p>
<h1 id='listable' class='heading'>Listable</h1>

<p>Listable is a declarative list framework for iOS, which allows you to concisely create rich, live updating list based layouts which are highly customizable across many axes: padding, spacing, number of columns, alignment, etc. It&rsquo;s designed to be performant: Handling lists of 10k+ items without issue on most devices.</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">setContent</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section-1"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>

        <span class="n">section</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="kt">DemoHeader</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"This Is A Header"</span><span class="p">)</span>

        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"And here is a row"</span><span class="p">)</span>
        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"And here is another row."</span><span class="p">)</span>

        <span class="k">let</span> <span class="nv">rows</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">"You can also map rows"</span><span class="p">,</span>
            <span class="s">"Like this"</span>
        <span class="p">]</span>

        <span class="n">section</span> <span class="o">+=</span> <span class="n">rows</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span>
            <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section-2"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>

        <span class="n">section</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="kt">DemoHeader</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Another Header"</span><span class="p">)</span>

        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"The last row."</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='features' class='heading'>Features</h2>
<h3 id='declarative-interface-amp-intelligent-updates' class='heading'>Declarative Interface &amp; Intelligent Updates</h3>

<p>The core power and benefit of Listable comes from its declarative-style API, which allows you to implement SwiftUI or React style one-way data flow within your app&rsquo;s list views, eliminating many common state management bugs you encounter with standard UITableView or UICollectionView delegate-based solutions. You only need to tell the list what should be in it right now – it does the hard parts of diffing the changes to perform rich animated updates when new content is provided.</p>

<p>Let&rsquo;s say you start with an empty table, like so:</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">setContent</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="c1">// No content right now.</span>
<span class="p">}</span>
</code></pre>

<p>And then push in new content, so there  is one row with one section:</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">setContent</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section-1"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>
        <span class="n">section</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="kt">DemoHeader</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"This Is A Header"</span><span class="p">)</span>

        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"And here is a row"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>This new section will be animated into place. If you then insert another row:</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">setContent</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section-1"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>
        <span class="n">section</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="kt">DemoHeader</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"This Is A Header"</span><span class="p">)</span>

        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"And here is a row"</span><span class="p">)</span>
        <span class="n">section</span> <span class="o">+=</span> <span class="kt">DemoItem</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"Another row!"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>It will also be animated into place by the list.  The same goes for any change you make to the table – a diff will be performed, and the changes will be animated into place. Content that did not change between updates will be unaffected.</p>
<h3 id='performant' class='heading'>Performant</h3>

<p>A core design principle of Listable is performance! Lists are <em>usually</em> small, but not always! For example, within Square Point of Sale, a seller may have an item catalog of 1,000, 10,000, or even more items. When designing Listable, it was important to ensure that it could support lists of these scales with minimum performance cost, to make it easy to build them without paying for performance, or without having to drop back down to standard <code>UITableView</code> or <code>UICollectionView</code> APIs, which are easy to misuse.</p>

<p>This performance is achieved through an internal batching system, which only queries and diffs the items needed to display the current scroll point, plus some scrollover. Views are only created for what is currently on screen. This allows culling of most content pushed into the list for long lists.</p>

<p>Further, height and sizing measurements are cached more efficiently than in a regular collection view implementation, which for large lists, can boost scrolling performance and prevent dropped frames.</p>
<h3 id='highly-customizable' class='heading'>Highly Customizable</h3>

<p>Listable makes very few assumptions of the appearance of your content. The currency you deal with is plain <code>UIViews</code> (not <code>UICollectionViewCells</code>), so you can draw content however you wish.</p>

<p>Further, the layout and appearance controls vended by <code>ListView</code> allow for customization of the layout to draw lists in nearly any way desired.</p>

<p>This is primarily controlled through the <code>Appearance</code> object:</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Appearance</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">backgroundColor</span> <span class="p">:</span> <span class="kt">UIColor</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">direction</span> <span class="p">:</span> <span class="kt">LayoutDirection</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">stickySectionHeaders</span> <span class="p">:</span> <span class="kt">Bool</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">list</span> <span class="p">:</span> <span class="kt">TableAppearance</span>
<span class="p">}</span>
</code></pre>

<p>You use the <code>TableAppearance.Sizing</code> struct to control the default measurements within the list: How tall are standard rows, headers, footers, etc.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">TableAppearance</span><span class="o">.</span><span class="kt">Sizing</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">itemHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">sectionHeaderHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">sectionFooterHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">listHeaderHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">listFooterHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">itemPositionGroupingHeight</span> <span class="p">:</span> <span class="kt">CGFloat</span>
<span class="p">}</span>
</code></pre>

<p>You can use <code>TableAppearance.Layout</code> to customize the padding of the entire list, how wide the list should be (eg, up to 700px, more than 400px, etc) plus control spacing between items, headers, and footers. </p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">TableAppearance</span><span class="o">.</span><span class="kt">Layout</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">padding</span> <span class="p">:</span> <span class="kt">UIEdgeInsets</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">width</span> <span class="p">:</span> <span class="kt">WidthConstraint</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">interSectionSpacingWithNoFooter</span> <span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">interSectionSpacingWithFooter</span> <span class="p">:</span> <span class="kt">CGFloat</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">sectionHeaderBottomSpacing</span> <span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">itemSpacing</span> <span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">itemToSectionFooterSpacing</span> <span class="p">:</span> <span class="kt">CGFloat</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">stickySectionHeaders</span> <span class="p">:</span> <span class="kt">Bool</span>
<span class="p">}</span>
</code></pre>

<p>Finally, the <code>Behavior</code> and  <code>Behavior.Underflow</code> allows customizing what happens when a list&rsquo;s content is shorter than its container view: Should the scroll view bounce, should the content be centered, etc.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Behavior</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">keyboardDismissMode</span> <span class="p">:</span> <span class="kt">UIScrollView</span><span class="o">.</span><span class="kt">KeyboardDismissMode</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">underflow</span> <span class="p">:</span> <span class="kt">Underflow</span>
</code></pre>
<pre class="highlight swift"><code>
<span class="kd">struct</span> <span class="kt">Underflow</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">alwaysBounce</span> <span class="p">:</span> <span class="kt">Bool</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">alignment</span> <span class="p">:</span> <span class="kt">Alignment</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="kt">Alignment</span> <span class="p">:</span> <span class="kt">Equatable</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">top</span>
        <span class="k">case</span> <span class="n">center</span>
        <span class="k">case</span> <span class="n">bottom</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='self-sizing-cells' class='heading'>Self-Sizing Cells</h3>

<p>Another common pain-point for standard <code>UITableViews</code> or <code>UICollectionViews</code> is handling dynamic and self sizing cells. Listable handles this transparently for you, and provides many ways to size content. Each <code>Item</code> has a <code>sizing</code> property, which can be set to any of the following values. <code>.default</code> pulls the default sizing of the item from the <code><a href="Structs/List/Measurement.html">List.Measurement</a></code> mentioned above, where as the <code>thatFits</code> and <code>autolayout</code> values size the item based on <code>sizeThatFits</code> and <code>systemLayoutSizeFitting</code>, respectively.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">enum</span> <span class="kt">Sizing</span> <span class="p">:</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="err">`</span><span class="k">default</span><span class="err">`</span>

    <span class="k">case</span> <span class="nf">fixed</span><span class="p">(</span><span class="kt">CGFloat</span><span class="p">)</span>

    <span class="k">case</span> <span class="nf">thatFits</span><span class="p">(</span><span class="kt">Constraint</span> <span class="o">=</span> <span class="o">.</span><span class="n">noConstraint</span><span class="p">)</span>

    <span class="k">case</span> <span class="nf">autolayout</span><span class="p">(</span><span class="kt">Constraint</span> <span class="o">=</span> <span class="o">.</span><span class="n">noConstraint</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h3 id='integrates-with-blueprint' class='heading'>Integrates With Blueprint</h3>

<p>Listable integrates closely with <a href="https://github.com/square/blueprint/">Blueprint</a>, Square&rsquo;s framework for declarative UI construction and management (if you&rsquo;ve used SwiftUI, Blueprint is similar). Listable provides wrapper types and default types to make using Listable lists within Blueprint elements simple, and to make it easy to build Listable items out of Blueprint elements.</p>

<p>All you need to do is take a dependency on the <code>BlueprintUILists</code> pod, and then <code>import BlueprintUILists</code> to begin using Blueprint integration.</p>

<p>In this example, we see how to declare a <code><a href="Structs/List.html">List</a></code> within a Blueprint element hierarchy.</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">elementRepresentation</span> <span class="p">:</span> <span class="kt">Element</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
        <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"podcasts"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>

            <span class="n">section</span> <span class="o">+=</span> <span class="k">self</span><span class="o">.</span><span class="n">podcasts</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span>
                <span class="kt">PodcastRow</span><span class="p">(</span><span class="nv">podcast</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>And in this example, we see how to create a simple <code><a href="Protocols/BlueprintItemContent.html">BlueprintItemContent</a></code> that uses Blueprint to render its content.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">DemoItem</span> <span class="p">:</span> <span class="kt">BlueprintItemContent</span><span class="p">,</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">text</span> <span class="p">:</span> <span class="kt">String</span>

    <span class="c1">// ItemContent</span>

    <span class="k">var</span> <span class="nv">identifierValue</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="n">text</span>
    <span class="p">}</span>

    <span class="c1">// BlueprintItemContent</span>

    <span class="kd">func</span> <span class="nf">element</span><span class="p">(</span><span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Element</span>
    <span class="p">{</span>
        <span class="k">var</span> <span class="nv">box</span> <span class="o">=</span> <span class="kt">Box</span><span class="p">(</span>
            <span class="nv">backgroundColor</span><span class="p">:</span> <span class="o">.</span><span class="n">white</span><span class="p">,</span>
            <span class="nv">cornerStyle</span><span class="p">:</span> <span class="o">.</span><span class="nf">rounded</span><span class="p">(</span><span class="nv">radius</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">),</span>
            <span class="nv">wrapping</span><span class="p">:</span> <span class="kt">Inset</span><span class="p">(</span>
                <span class="nv">uniformInset</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
                <span class="nv">wrapping</span><span class="p">:</span> <span class="kt">Label</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">box</span><span class="o">.</span><span class="n">borderStyle</span> <span class="o">=</span> <span class="o">.</span><span class="nf">solid</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="o">.</span><span class="nf">white</span><span class="p">(</span><span class="mf">0.9</span><span class="p">),</span> <span class="nv">width</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">box</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='instruments-app-integration' class='heading'>Instruments.app Integration</h2>

<p>Listable provides integration with the <code>os_signpost</code> API for measuring the duration of events in your application. If you are experiencing issues with list performance in your app, you can profile it in Instruments, and add the <code>os_signpost</code> instrument to inspect the timing for various layout and update passes.</p>
<h2 id='primary-api-amp-surface-area' class='heading'>Primary API &amp; Surface Area</h2>

<p>Most of your interaction will be three primary families of types: <code>ListView</code>, <code>Item</code>,  <code>HeaderFooter</code>, and <code>Section</code>. </p>
<h3 id='listview' class='heading'>ListView</h3>

<p>The list that you put content into! Beyond allocating a list and putting it on screen, the bulk of your interaction with <code>ListView</code> will be through the <code>setContent</code> API shown above.</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">setContent</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="c1">// Set list appearance, specify content, etc...</span>
<span class="p">}</span>
</code></pre>

<p>What is that <code>list</code> parameter, you ask&hellip;?</p>
<h3 id='listproperties' class='heading'>ListProperties</h3>

<p><code>ListProperties</code> is a struct which contains all the information required to render a list update.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">ListProperties</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">animatesChanges</span> <span class="p">:</span> <span class="kt">Bool</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">layoutType</span> <span class="p">:</span> <span class="kt">ListLayoutType</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">appearance</span> <span class="p">:</span> <span class="kt">Appearance</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="p">:</span> <span class="kt">Behavior</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">autoScrollAction</span> <span class="p">:</span> <span class="kt">AutoScrollAction</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">scrollInsets</span> <span class="p">:</span> <span class="kt">ScrollInsets</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">accessibilityIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">content</span> <span class="p">:</span> <span class="kt">Content</span>
<span class="p">}</span>
</code></pre>

<p>This allows you to configure the list view however needed within the <code>configure</code> update.</p>
<h3 id='item' class='heading'>Item</h3>

<p>You can think of <code>Item</code> as the wrapper for the content <em>you</em> provide to the list – similar to how a <code>UITableViewCell</code> or <code>UICollectionViewCell</code> wraps a content view and provides other configuration options. </p>

<p>An <code>Item</code> is what you add to a section to represent a row in a list. It contains your provided content (<code>ItemContent</code>), alongside things like sizing, layout customization, selection behavior, reordering behavior, and callbacks which are performed when an item is selected, displayed, etc.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Item</span><span class="o">&lt;</span><span class="kt">Content</span><span class="p">:</span><span class="kt">ItemContent</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">AnyItem</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">identifier</span> <span class="p">:</span> <span class="kt">Content</span><span class="o">.</span><span class="kt">Identifier</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">content</span> <span class="p">:</span> <span class="kt">Content</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">sizing</span> <span class="p">:</span> <span class="kt">Sizing</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">layout</span> <span class="p">:</span> <span class="kt">ItemLayout</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">selection</span> <span class="p">:</span> <span class="kt">ItemSelection</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">swipeActions</span> <span class="p">:</span> <span class="kt">SwipeActions</span><span class="p">?</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">reordering</span> <span class="p">:</span> <span class="kt">ItemReordering</span><span class="p">?</span>

    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">OnSelect</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Content</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">onSelect</span> <span class="p">:</span> <span class="kt">OnSelect</span><span class="p">?</span>

    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">OnDeselect</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Content</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">onDeselect</span> <span class="p">:</span> <span class="kt">OnDeselect</span><span class="p">?</span>

    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">OnDisplay</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Content</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">onDisplay</span> <span class="p">:</span> <span class="kt">OnDisplay</span><span class="p">?</span>

    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">OnEndDisplay</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Content</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">onEndDisplay</span> <span class="p">:</span> <span class="kt">OnEndDisplay</span><span class="p">?</span>
<span class="p">}</span>
</code></pre>

<p>You can add an item to a section via either the <code>add</code> function, or via the <code>+=</code> override. </p>
<pre class="highlight swift"><code><span class="n">section</span> <span class="o">+=</span> <span class="kt">Item</span><span class="p">(</span>
    <span class="kt">YourContent</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Hello, World!"</span><span class="p">),</span>

    <span class="nv">sizing</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span>
    <span class="nv">selection</span><span class="p">:</span> <span class="o">.</span><span class="n">notSelectable</span>
<span class="p">)</span>
</code></pre>

<p>However, if you want to use all default values from the <code>Item</code> initializer, you can skip a step and simply add your <code>ItemContent</code> to the section directly.</p>
<pre class="highlight swift"><code><span class="n">section</span> <span class="o">+=</span> <span class="kt">YourContent</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"Hello, World!"</span><span class="p">)</span>
</code></pre>
<h3 id='itemcontent' class='heading'>ItemContent</h3>

<p>The core value type which represents an item&rsquo;s content.</p>

<p>This view model describes the content of a given row / item, via the <code>identifier</code>, plus the <code>wasMoved</code> and <code>isEquivalent</code> methods.</p>

<p>To convert an <code>ItemContent</code> into views for display, the  <code>createReusableContentView(:)</code> method is called to create a reusable view to use when displaying the content (the same happens for background views as well).</p>

<p>To prepare the views for display, the <code>apply(to:for:with:)</code> method is called, which is where you push the content from your <code>ItemContent</code> onto the provided views.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">ItemContent</span>
<span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">IdentifierValue</span> <span class="p">:</span> <span class="kt">Hashable</span>

    <span class="k">var</span> <span class="nv">identifierValue</span> <span class="p">:</span> <span class="kt">IdentifierValue</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">apply</span><span class="p">(</span>
        <span class="n">to</span> <span class="nv">views</span> <span class="p">:</span> <span class="kt">ItemContentViews</span><span class="o">&lt;</span><span class="k">Self</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="k">for</span> <span class="nv">reason</span><span class="p">:</span> <span class="kt">ApplyReason</span><span class="p">,</span>
        <span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span>
    <span class="p">)</span>

    <span class="kd">func</span> <span class="nf">wasMoved</span><span class="p">(</span><span class="n">comparedTo</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>

    <span class="kd">associatedtype</span> <span class="kt">ContentView</span><span class="p">:</span><span class="kt">UIView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableContentView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ContentView</span>

    <span class="kd">associatedtype</span> <span class="kt">BackgroundView</span><span class="p">:</span><span class="kt">UIView</span> <span class="o">=</span> <span class="kt">UIView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">BackgroundView</span>

    <span class="kd">associatedtype</span> <span class="kt">SelectedBackgroundView</span><span class="p">:</span><span class="kt">UIView</span> <span class="o">=</span> <span class="kt">BackgroundView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableSelectedBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">SelectedBackgroundView</span>
<span class="p">}</span>
</code></pre>

<p>Note however, you usually do not need to implement all these methods! For example, if your <code>ItemContent</code> is <code>Equatable</code>, you get <code>isEquivalent</code> for free – and by default, <code>wasMoved</code> is the same was <code>isEquivalent(other:) == false</code>.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">extension</span> <span class="kt">ItemContent</span>
<span class="p">{</span>
    <span class="kd">func</span> <span class="nf">wasMoved</span><span class="p">(</span><span class="n">comparedTo</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="nf">isEquivalent</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">public</span> <span class="kd">extension</span> <span class="kt">ItemContent</span> <span class="k">where</span> <span class="k">Self</span><span class="p">:</span><span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span> <span class="o">==</span> <span class="n">other</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The <code>BackgroundView</code> and <code>SelectedBackgroundView</code> views also default to a plain <code>UIView</code> which do not display any content of their own. You only need to provide these background views if you wish to support customization of the appearance of the item during highlighting and selection.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">extension</span> <span class="kt">ItemContent</span> <span class="k">where</span> <span class="kt">BackgroundView</span> <span class="o">==</span> <span class="kt">UIView</span>
<span class="p">{</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">BackgroundView</span>
    <span class="p">{</span>
        <span class="kt">BackgroundView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The <code>SelectedBackgroundView</code> also defaults to the type of <code>BackgroundView</code> unless you explicitly want two different view types.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">extension</span> <span class="kt">ItemContent</span> <span class="k">where</span> <span class="kt">BackgroundView</span> <span class="o">==</span> <span class="kt">SelectedBackgroundView</span>
<span class="p">{</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableSelectedBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">BackgroundView</span>
    <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">createReusableBackgroundView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>This is all a bit abstract, so consider the following example: An <code>ItemContent</code> which provides a title and detail label.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">SubtitleItem</span> <span class="p">:</span> <span class="kt">ItemContent</span><span class="p">,</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">title</span> <span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">detail</span> <span class="p">:</span> <span class="kt">String</span>

    <span class="c1">// ItemContent</span>

    <span class="kd">func</span> <span class="nf">apply</span><span class="p">(</span><span class="n">to</span> <span class="nv">views</span> <span class="p">:</span> <span class="kt">ItemContentViews</span><span class="o">&lt;</span><span class="k">Self</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">for</span> <span class="nv">reason</span><span class="p">:</span> <span class="kt">ApplyReason</span><span class="p">,</span> <span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">views</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
        <span class="n">views</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">detailLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">detail</span>
    <span class="p">}</span>

    <span class="kd">typealias</span> <span class="kt">ContentView</span> <span class="o">=</span> <span class="kt">View</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableContentView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ContentView</span>
    <span class="p">{</span>
        <span class="kt">View</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">View</span> <span class="p">:</span> <span class="kt">UIView</span>
    <span class="p">{</span>
        <span class="k">let</span> <span class="nv">titleLabel</span> <span class="p">:</span> <span class="kt">UILabel</span>
        <span class="k">let</span> <span class="nv">detailLabel</span> <span class="p">:</span> <span class="kt">UILabel</span>

        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='headerfooter' class='heading'>HeaderFooter</h3>

<p>How to describe a header or footer within a list. Very similar API to <code>Item</code>, but with less stuff, as headers and footers are display-only.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">HeaderFooter</span><span class="o">&lt;</span><span class="kt">Content</span><span class="p">:</span><span class="kt">HeaderFooterContent</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">AnyHeaderFooter</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">content</span> <span class="p">:</span> <span class="kt">Content</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">sizing</span> <span class="p">:</span> <span class="kt">Sizing</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">layout</span> <span class="p">:</span> <span class="kt">HeaderFooterLayout</span>
<span class="p">}</span>
</code></pre>

<p>You set headers and footers on sections via the <code>header</code> and <code>footer</code> parameter.</p>
<pre class="highlight swift"><code><span class="k">self</span><span class="o">.</span><span class="n">listView</span><span class="o">.</span><span class="n">configure</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
    <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section-1"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>
        <span class="n">section</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="kt">DemoHeader</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"This Is A Header"</span><span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">footer</span> <span class="o">=</span> <span class="kt">DemoFooter</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="s">"And this is a footer. Please check the EULA for details."</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='headerfootercontent' class='heading'>HeaderFooterContent</h4>

<p>Again, a similar API to  <code>ItemContent</code>, but with a reduced surface area, given the reduced concerns of header and footers.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">HeaderFooterContent</span>
<span class="p">{</span>
    <span class="kd">func</span> <span class="nf">apply</span><span class="p">(</span><span class="n">to</span> <span class="nv">view</span> <span class="p">:</span> <span class="kt">Appearance</span><span class="o">.</span><span class="kt">ContentView</span><span class="p">,</span> <span class="nv">reason</span> <span class="p">:</span> <span class="kt">ApplyReason</span><span class="p">)</span>

    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>

    <span class="kd">associatedtype</span> <span class="kt">ContentView</span><span class="p">:</span><span class="kt">UIView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableContentView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ContentView</span>

    <span class="kd">associatedtype</span> <span class="kt">BackgroundView</span><span class="p">:</span><span class="kt">UIView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">BackgroundView</span>

    <span class="kd">associatedtype</span> <span class="kt">PressedBackgroundView</span><span class="p">:</span><span class="kt">UIView</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusablePressedBackgroundView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">PressedBackgroundView</span>
<span class="p">}</span>
</code></pre>

<p>As is with <code>Item</code>, if your <code>HeaderFooterContent</code> is <code>Equatable</code>, you get <code>isEquivalent</code> for free.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">extension</span> <span class="kt">HeaderFooterContent</span> <span class="k">where</span> <span class="k">Self</span><span class="p">:</span><span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span> <span class="o">==</span> <span class="n">other</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>A standard implementation may look like this:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Header</span> <span class="p">:</span> <span class="kt">HeaderFooterContent</span><span class="p">,</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">title</span> <span class="p">:</span> <span class="kt">String</span>

    <span class="kd">func</span> <span class="nf">apply</span><span class="p">(</span><span class="n">to</span> <span class="nv">view</span> <span class="p">:</span> <span class="kt">Appearance</span><span class="o">.</span><span class="kt">ContentView</span><span class="p">,</span> <span class="k">for</span> <span class="nv">reason</span><span class="p">:</span> <span class="kt">ApplyReason</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">view</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
    <span class="p">}</span>

    <span class="kd">typealias</span> <span class="kt">ContentView</span> <span class="o">=</span> <span class="kt">View</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">createReusableContentView</span><span class="p">(</span><span class="nv">frame</span> <span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ContentView</span>
    <span class="p">{</span>
        <span class="kt">View</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">View</span> <span class="p">:</span> <span class="kt">UIView</span>
    <span class="p">{</span>
        <span class="k">let</span> <span class="nv">titleLabel</span> <span class="p">:</span> <span class="kt">UILabel</span>

        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='section' class='heading'>Section</h3>

<p><code>Section</code> – surprise – represents a given section in a list. Most of your interaction with <code>Section</code> will be through the init &amp; builder API, as shown above.</p>
<pre class="highlight swift"><code><span class="kt">Section</span><span class="p">(</span><span class="s">"section"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>
    <span class="n">section</span> <span class="o">+=</span> <span class="k">self</span><span class="o">.</span><span class="n">podcasts</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span>
        <span class="kt">PodcastRow</span><span class="p">(</span><span class="nv">podcast</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>However, section has many properties to allow for configuration. You can customize the layout, the number of and layout of columns, set the header and footer, and obviously provide items, via the <code>items</code> property, and via the many provided overrides of the <code>+=</code> operator.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Section</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">layout</span> <span class="p">:</span> <span class="kt">Layout</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">columns</span> <span class="p">:</span> <span class="kt">Columns</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">header</span> <span class="p">:</span> <span class="kt">AnyHeaderFooter</span><span class="p">?</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">footer</span> <span class="p">:</span> <span class="kt">AnyHeaderFooter</span><span class="p">?</span>

    <span class="kd">public</span> <span class="k">var</span> <span class="nv">items</span> <span class="p">:</span> <span class="p">[</span><span class="kt">AnyItem</span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
<h2 id='integration-with-blueprint' class='heading'>Integration With Blueprint</h2>

<p>If you&rsquo;re using Blueprint integration via the  <code>BlueprintUILists</code> module, you will also interact with the following types.</p>
<h3 id='list' class='heading'>List</h3>

<p>When using <code>ListView</code> directly, you&rsquo;d use <code>list.configure { list in ... }</code> to set the content of a list.</p>

<p>However, Blueprint element trees are just descriptions of UI – as such, <code><a href="Structs/List.html">List</a></code> is just a Blueprint <code>Element</code> which describes a list. The parameter passed to <code>List { list in ... }</code> is the same type (<code>ListProperties</code>) that is passed to  <code>list.configure { list in ... }</code>.</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">elementRepresentation</span> <span class="p">:</span> <span class="kt">Element</span> <span class="p">{</span>
    <span class="kt">List</span> <span class="p">{</span> <span class="n">list</span> <span class="k">in</span>
        <span class="n">list</span> <span class="o">+=</span> <span class="kt">Section</span><span class="p">(</span><span class="s">"section"</span><span class="p">)</span> <span class="p">{</span> <span class="n">section</span> <span class="k">in</span>

            <span class="n">section</span> <span class="o">+=</span> <span class="k">self</span><span class="o">.</span><span class="n">podcasts</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span>
                <span class="kt">PodcastRow</span><span class="p">(</span><span class="nv">podcast</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='blueprintitemcontent' class='heading'>BlueprintItemContent</h3>

<p><code><a href="Protocols/BlueprintItemContent.html">BlueprintItemContent</a></code> simplifies the <code>ItemContent</code> creation process, asking you for a Blueprint <code>Element</code> description, instead of view types and view instances. </p>

<p>Unless you are supporting highlighting and selection of your <code>ItemContent</code>, you do not need to provide implementations of <code>backgroundElement(:)</code> and <code>selectedBackgroundElement(:)</code> – they default to returning nil. Similar to <code>ItemContent</code>, <code>wasMoved(:)</code> and <code>isEquivalent(:)</code> are also provided based on <code>Equatable</code> conformance.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">BlueprintItemContent</span> <span class="p">:</span> <span class="kt">ItemContent</span>
<span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">IdentifierValue</span> <span class="p">:</span> <span class="kt">Hashable</span>

    <span class="k">var</span> <span class="nv">identifierValue</span> <span class="p">:</span> <span class="kt">IdentifierValue</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">wasMoved</span><span class="p">(</span><span class="n">comparedTo</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>

    <span class="kd">func</span> <span class="nf">element</span><span class="p">(</span><span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Element</span>

    <span class="kd">func</span> <span class="nf">backgroundElement</span><span class="p">(</span><span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Element</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">selectedBackgroundElement</span><span class="p">(</span><span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Element</span><span class="p">?</span>
<span class="p">}</span>
</code></pre>

<p>A standard <code><a href="Protocols/BlueprintItemContent.html">BlueprintItemContent</a></code> may look something like this:</p>
<pre class="highlight swift"><code>
<span class="kd">struct</span> <span class="kt">MyPerson</span> <span class="p">:</span> <span class="kt">BlueprintItemContent</span><span class="p">,</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">name</span> <span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">phoneNumber</span> <span class="p">:</span> <span class="kt">String</span>

    <span class="k">var</span> <span class="nv">identifierValue</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">name</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">element</span><span class="p">(</span><span class="n">with</span> <span class="nv">info</span> <span class="p">:</span> <span class="kt">ApplyItemContentInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Element</span> <span class="p">{</span>
        <span class="kt">Row</span> <span class="p">{</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Label</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="n">name</span><span class="p">))</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Spacer</span><span class="p">())</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Label</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="n">name</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">inset</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='blueprintheaderfootercontent' class='heading'>BlueprintHeaderFooterContent</h3>

<p>Similarly, <code><a href="Protocols/BlueprintHeaderFooterContent.html">BlueprintHeaderFooterContent</a></code> makes creating a header or footer easy – just implement <code>elementRepresentation</code>, which provides the content element for your header or footer. As usual, <code>isEquivalent(to:)</code> is provided if your type is <code>Equatable</code>.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">BlueprintHeaderFooterContent</span> <span class="p">:</span> <span class="kt">HeaderFooterElement</span>
<span class="p">{</span>
    <span class="kd">func</span> <span class="nf">isEquivalent</span><span class="p">(</span><span class="n">to</span> <span class="nv">other</span> <span class="p">:</span> <span class="k">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>

    <span class="k">var</span> <span class="nv">elementRepresentation</span> <span class="p">:</span> <span class="kt">Element</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>A standard <code><a href="Protocols/BlueprintHeaderFooterContent.html">BlueprintHeaderFooterContent</a></code> may look something like this:</p>
<pre class="highlight swift"><code>
<span class="kd">struct</span> <span class="kt">MyHeader</span> <span class="p">:</span> <span class="kt">BlueprintHeaderFooterContent</span><span class="p">,</span> <span class="kt">Equatable</span>
<span class="p">{</span>
    <span class="k">var</span> <span class="nv">name</span> <span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">itemCount</span> <span class="p">:</span> <span class="kt">String</span>

    <span class="k">var</span> <span class="nv">elementRepresentation</span> <span class="p">:</span> <span class="kt">Element</span> <span class="p">{</span>
        <span class="kt">Row</span> <span class="p">{</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Label</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="n">name</span><span class="p">))</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Spacer</span><span class="p">())</span>
            <span class="nv">$0</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">child</span><span class="p">:</span> <span class="kt">Label</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="n">itemCount</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">inset</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='getting-started' class='heading'>Getting Started</h2>

<p>Listable is published on CocoaPods. You can add a dependency on Listable or it&rsquo;s Blueprint wrapper with the following in your Podspec: </p>
<pre class="highlight plaintext"><code>s.dependency 'ListableUI'
s.dependency 'BlueprintUILists'
</code></pre>

<p>If you want to depend on bleeding-edge changes, you can add the pods to your Podfile via the git repo like so:</p>
<pre class="highlight plaintext"><code>  pod 'BlueprintUILists', git: 'ssh://git@github.com:kyleve/Listable.git'
  pod 'ListableUI', git: 'ssh://git@github.com:kyleve/Listable.git'
</code></pre>
<h2 id='demo-project' class='heading'>Demo Project</h2>

<p>If you&rsquo;d like to see examples of Listable in use, clone the repo, and then run <code>bundle exec pod install</code> in the root of the repo. This will create the <code>Demo/Demo.xcworkspace</code> workspace, which you can open and run. It contains examples of various types of screens and use cases.</p>
<h1 id='other-neat-stuff' class='heading'>Other Neat Stuff</h1>
<h3 id='you-can-nest-lists-in-other-lists' class='heading'>You can nest Lists in other lists.</h3>

<p>You can nest horizontal scrolling Lists within vertical scrolling lists to create advanced, custom layouts. Listable provides a <code>ListItemElement</code> to make this easy.</p>
<h3 id='you-can-override-many-layout-parameters-on-a-per-item-and-per-header-footer-basis' class='heading'>You can override many layout parameters on a per-item and per-header/footer basis.</h3>

<p>By setting the <code>layout</code> parameter on <code>Item</code> or <code>HeaderFooter</code>, you can specify the alignment of each item within a layout, how much padding it should have, how much spacing it can have, etc.</p>
<h1 id='appendix' class='heading'>Appendix</h1>
<h2 id='implementation-details' class='heading'>Implementation Details</h2>
<h3 id='rendering-amp-display' class='heading'>Rendering &amp; Display</h3>

<p>Listable is built on top of <code>UICollectionView</code>, with a custom <code>UICollectionViewLayout</code> though this is not exposed to consumers.</p>
<h3 id='performance' class='heading'>Performance</h3>

<p>Internally, performance is achieved through transparent batching of content that is loaded into the collection view itself. This allows pushing large amounts
of content into the list, but <code>ListView</code> is intelligent enough to only load, measure, diff, etc, enough of that content to display the current scroll position,
plus some scroll overflow. In practice, this means that even if you put 50,000 items into a list, if the user is scrolled at the top of the table, only a few hundred
items will be measured, diffed, and take up computation time during initial rendering and updates. This allows performance to remain nearly constant, regardless
of what content is pushed into the list. The farther down a user scrolls, the more computation must be completed.</p>
<h3 id='view-state-management' class='heading'>View State Management</h3>

<p>Internally, every item drawn on screen and visible in the list is represented by a long-lived <code>PresentationState</code> instance, which tracks visible cells, sizing measurements, etc.
This long lived object allows an extra layer which means it&rsquo;s easy to cache height calculations across multiple content updates in the list view, allowing for further performance
improvements and optimizations. This is transparent to the developer.</p>
<h2 id='why' class='heading'>Why?</h2>

<p>Building rich and interactive list views and lists on iOS remains a challenge. Maintaining state and performing animations on changes is tricky and error prone. More often than not, there are lurking state bugs that result in inconsistent data or crashes that are hard to diagnose and debug.</p>

<p>Historically, we have managed list view state one of a few ways&hellip;</p>

<p>1) Via Core Data and NSFetchedResultsController, which handles diffing and updates. However, this binds your UI tightly to the underlying core data model, which makes changes difficult and error prone. You end up needing to model UI concerns deep in your Core Data model to sort and section your data as you want. No good.</p>

<p>2) Use other options such as common block-based table view or collection view builders – which abstracts some of the complexity away from developers, but it still deals in the currency of cells and views – and makes it difficult to properly handle animations and updates.</p>

<p>3) Sometimes, you end up just giving up and calling reloadData() any time anything in your table’s data source changes – this sucks because users don’t see animations which indicate to them what changed.</p>

<p>4) Or, even worse, you end up managing insertions, deletions, and updates yourself, which usually goes something like this…</p>

<blockquote>
<p>Call beginUpdates</p>

<p>Call insertRow:atIndexPath:
Call insertRow:atIndexPath:
Call moveRowAtIndexPath:toIndexPath:
Etc..</p>

<p>Call endUpdates</p>

<p>Assertion failure in UITableView/UICollectionView.m:20000000: The number of rows before the update is not equal to &gt; the number of rows after the update, plus or minus the added and removed rows. You suck, nerd!</p>

<p>[Crash]</p>
</blockquote>

<p>Needless to say, none of these options are great, and all of these are state-of-the-art circa about 2011 – which was a long time ago.</p>
<h2 id='legal-stuff' class='heading'>Legal Stuff</h2>

<p>Copyright 2019 Square, Inc.</p>

<p>Licensed under the Apache License, Version 2.0 (the &ldquo;License&rdquo;); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &ldquo;AS IS&rdquo; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2023 <a class="link" href="https://github.com/kyleve/Listable" target="_blank" rel="external noopener">Kyle</a>. All rights reserved. (Last updated: 2023-08-08)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
